<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="user_action" model="ir.actions.act_window">
        <field name="name">Users</field>
        <field name="res_model">connect.user</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="connect.users_menu"
            sequence="75"
            parent="connect.connect_voice_menu"
            name="Users"
            action="connect.user_action"/>

    <record id="connect.user_list" model="ir.ui.view">
        <field name="name">connect.user_list</field>
        <field name="model">connect.user</field>
        <field name="arch" type="xml">
            <tree>
                <field name="username"/>
                <field name="user"/>
                <field name="exten_number" string="Exten"/>
                <field name="outgoing_callerid"/>
                <field name="user"/>
                <field name="ring_first"/>
                <field name="sip_enabled" string="SIP"/>
                <field name="client_enabled" string="Web"/>
                <field name="application"/>
                <field name="record_calls"/>
                <field name="domain"/>
            </tree>
        </field>
    </record>

    <record id="connect_user_form" model="ir.ui.view" >
        <field name="name">connect_user_form</field>
        <field name="model">connect.user</field>
        <field name="arch" type="xml">
            <form>
                <header>
                    <button name="create_extension" type="object" string="Extension" class="btn btn-primary"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <label class="oe_edit_only" for="user"/>
                            <field name="user" attrs="{'required': [('client_enabled', '=', True)]}" placeholder="Odoo account..."/>
                        </h1>
                    </div>
                    <field name="id" attrs="{'invisible': 1}"/>
                    <notebook>
                        <page name="phone" string="Phone">
                            <group>
                                <group>
                                    <field name="username" placeholder="PBX username..."
                                        attrs="{'required': [('id', '!=', False)]}"/>
                                    <field name="domain"
                                        attrs="{'required': [('id', '!=', False)]}"/>
                                </group>
                                <group>
                                    <field name="exten_number" widget="phone"/>
                                </group>
                            </group>
                            <group>
                                <group string="SIP Phone">
                                    <field name="sip_enabled" string="Enabled"/>
                                    <field name="password" password="1"
                                        attrs="{'invisible': [('sip_enabled', '=', False)]}"/>
                                    <field name="sip_ring_timeout" string="Ring Timeout"
                                        attrs="{'required': [('sip_enabled', '=', True)], 'invisible': [('sip_enabled', '=', False)]}"/>
                                    <field name='uri' attrs="{'invisible': [('sip_enabled', '=', False)]}"/>
                                </group>
                                <group string="WEB Phone">
                                    <field name="client_enabled" string="Enabled"/>
                                    <field name="client_ring_timeout" string="Ring Timeout"
                                        attrs="{'invisible': [('client_enabled', '=', False)]}"/>
                                </group>
                            </group>
                        </page>
                        <page name="callflow" string="CallFlow">
                            <group>
                                <group>
                                    <field name="outgoing_callerid" placeholder="Outgoing CallerId number or empty for the default..."/>
                                    <field name="record_calls"/>
                                    <field name="ring_first" attrs="{'readonly': ['|', ('sip_enabled', '=', False), ('client_enabled', '=', False)]}"/>
                                </group>
                                <group>
                                    <field name="voicemail_enabled"/>
                                    <field name="voicemail_prompt"
                                        attrs="{'invisible': [('voicemail_enabled', '=', False)], 'required': [('voicemail_enabled', '=', True)]}"/>
                                    <field name="application"/>
                                </group>
                            </group>
                        </page>
                        <page name="settings" string="Settings">
                            <group>
                                <group>
                                    <field name="missed_calls_notify"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

</odoo>